// Generated by JGateCodegenPlugin. DO NOT EDIT!

package ${schemasPackage}.builder;

import com.stroganov.jgate.Application;
import $listenersPackage.*;
import $subscribersPackage.*;
import ru.micexrts.cgate.CGateException;

public class SchemasBuilder {
    private final Application.DataFeedFabric dfFabric;

    private SchemasBuilder(final Application.DataFeedFabric dfFabric) {
        this.dfFabric = dfFabric;
    }
    public static Application.SchemasBuilderFabric<SchemasBuilder> getSchemasBuilderFabric() {
        return new Application.SchemasBuilderFabric<SchemasBuilder>() {
            @Override
            public SchemasBuilder createInstance(final Application.DataFeedFabric dataFeedFabric) {
                return new SchemasBuilder(dataFeedFabric);
            }
        };
    }
#foreach ($scheme in $schemas)
    public SchemasBuilder apply$scheme.getName()(
            String listenerName,
            String fortsStream,
            String cgateListenerOpenSettings,
            $scheme.getName()Listener listener
    ) throws CGateException {
        dfFabric.createListener(String.format("p2repl://%s;scheme=|FILE|%s|%s;name=%s",
                                              fortsStream,
                                              ${scheme.getName()}Subscriber.schemeFile,
                                              ${scheme.getName()}Subscriber.schemeName,
                                              listenerName),
                                cgateListenerOpenSettings,
                                new FortsFutInfoReplSubscriber(listener));
        return this;
    }
#end
}
